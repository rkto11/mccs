<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="icon" type="image/png" href="./images/icon.png">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8" crossorigin="anonymous"></script>
	<script src="./js/jquery-3.6.1.min.js"></script>
	<script src="./js/jquery-ui.min.js"></script>
	<link rel="stylesheet" type="text/css" href="./css/jquery-ui.structure.min.css">
	<link rel="stylesheet" type="text/css" href="./css/datatables.min.css"/>
	<link href="./css/style.css" type="text/css" rel="stylesheet">
	<script src="./js/d3.min.js"></script>
	<script src="./js/jquery.csv.js"></script>
	<script src="./js/datatables.min.js"></script>
	<script src="./js/createtables.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.15.3/xlsx.full.min.js"></script>
	<script src="./js/printThis.js"></script>
	
	<title>Plans, Policy, and Analysis</title>
</head>

<body>
	<nav id="mynav" class="navbar navbar-expand-md sticky-top">
  		<div class="container-fluid">
    			<a class="navbar-brand" style="color:#ffffff">PPBEA</a>
    			<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mynavbar">
      				<span class="navbar-toggler-icon"></span>
    			</button>
    			<div class="collapse navbar-collapse" id="mynavbar">
      				<ul class="nav nav-pills me-auto" role="tablist">
        				<li class="nav-item">
          					<button class="nav-link active" data-bs-toggle="pill" data-bs-target="#home" type="button" role="tab" id="homebtn" onclick="topFunction()">Home</button>
        				</li>
        				<li class="nav-item"> 
          					<button class="nav-link" data-bs-toggle="pill" data-bs-target="#facilities" type="button" role="tab" id="facbtn" onclick="topFunction()">Facilities</button>
        				</li>
        				<li class="nav-item">
						<button class="nav-link" data-bs-toggle="pill" data-bs-target="#facrecap" type="button" role="tab" id="facrecapbtn" onclick="topFunction()">Facilities ReCap Plan</button>
        				</li>
					<!-- <li class="nav-item">
						<button class="nav-link" data-bs-toggle="pill" data-bs-target="#lodging" type="button" role="tab" id="logbtn" onclick="topFunction()">Official Lodging</button>
        				</li>
					<li class="nav-item">
						<button class="nav-link" data-bs-toggle="pill" data-bs-target="#catc" type="button" role="tab" id="catcbtn">Cat C</button onclick="topFunction()">
        				</li> -->
					<li class="nav-item">
						<button class="nav-link" data-bs-toggle="pill" data-bs-target="#dataentry" type="button" role="tab" id="databtn" onclick="topFunction()">Data Entry</button>
						</li>
     				 </ul>
    			</div>
  		</div>
	</nav>

    <div class="tab-content" id="contents">

		<div id="home" class="tab-pane container fade active show">
				<div class="container-fluid text-center">
					<img src="./images/16_MCCSlogo_Comp.png" class="img-fluid" alt="MCCS Logo" style="max-height: 300px;">
					<h1>PPBEA Reform</h1>
				</div>

				<h2 id="introduction">INTRODUCTION</h2>
				<p>Over the last two decades, our warfighters and their families have faced many challenges and made great sacrifices; yet they remain resilient and committed to supporting our Marine Corps. As the warfighters have remained faithful to the Corps, Marine Corps Community Services (MCCS) stayed faithful to them and the sacrifices they continue to make on a daily basis by supporting their success through a coordinated system of services across the MCCS portfolio. MCCS works diligently to enhance operational readiness, resilience, and total fitness for Marines and their families by routinely assessing needs and seeking innovative solutions to provide effective and relevant programs and services.</p>
				<p>This strategic report is intended to inform and advance the Marine Corps Community Services (MCCS) Planning, Programming, Budget, Execution, and Audit/Assessment (PPBEA) reforms and fiscal guidance. Other tactical plans will be developed to operationalize and align MCCS planning endeavors.</p>
				<h2 id="an-enduring-mccs-mission">AN ENDURING MCCS MISSION</h2>
				<p>MCCS’ enduring mission is to take care of our Marines, Sailors, and their families in order to support the Marine Corps’ overall readiness and warfighting mission. MCCS provides a comprehensive and effective support system - from recruitment through separation or retirement, which supports readiness, preparedness, fitness, health, and overall quality of life. MCCS capabilities are delivered through three critical areas:</p>
				<h3 id="marine-and-family-programs">Marine and Family Programs</h3>
				<p>Marine and Family Programs provides a comprehensive and effective support system which improves readiness, preparedness, fitness, health, and overall quality of life, from recruitment through separation/retirement. Well-established programs, such as Community Counseling and Family Advocacy, and new initiatives such as implementation of a prevention strategy across the fleet, demonstrate MCCS’ commitment to families is strong and MCCS continues to provide support for the unique stresses and challenges USMC families face throughout a Marine’s career.</p>
				<h3 id="semper-fit-and-recreation">Semper Fit and Recreation</h3>
				<p>Semper Fit and Recreation capabilities provide commanders with a team of fitness experts, health educators, and sports and recreation professionals. The Semper Fit and Recreation Program improves military readiness and effectiveness through comprehensive human performance, fitness, sports, health education, and recreation programs designed to increase lethality and operational readiness. Semper Fit promotes a positive culture that deters negative behaviors, improves quality of life and serves as a critical arm in the prevention continuum. Semper Fit and Recreation focuses on the health protection and health sustainment of warfighters and their family members by supporting an individual’s proactive and actionable approach to improving and maintaining physical, emotional, and psychological resiliency.</p>
				<h3 id="business-and-support-services">Business and Support Services</h3>
				<p>The Business and Support Services of MCCS is about supporting Mission, Marines and their families by Investing in Marines for Duty Home and Self. The Marine Corps is most successful when Marines and families are equipped with services and tools they need to meet an era of persistent conflict, natural disasters, world pandemics, and the challenges of day-to-day life in the 21st century. A Marine’s ability to prevail over future challenges will depend on the strength of our force, the strength of our families,and our ability to navigate the ever-challenging environment that comes with a military lifestyle. There is an inherent understanding that our Business relevancy is aligned with mission and Marines. Our business portfolio is twofold; to develop solutions to meet the ever-changing needs of Marines while providing critical resources to support important MWR programs. The Business Portfolio includes activities that meet daily needs of Marines and families to include the Marine Corps Exchange, Marine Marts, Uniform Support, Food and PCS/TDY Lodging. Additionally, it includes an array of recreational activities that provide well-being, morale and a healthy lifestyle during dwell time.</p>
				<p>The Business Portfolio also includes Support Services that provides Non-appropriated fund (NAF) Back office support across the total MCCS Enterprise, including Family Programs, Semper Fit and the Business Services. The consolidated back-office services include Information Technology, Human Resources, Finance and Accounting, Buying and Procurement, Training and Construction. Several innovative common support efficiency reforms are underway to include the stand-up of a Global Business Services center for NAF transactional accounting, and the standardization of common support across the MCCS enterprise as a precursor to developing a full cost of ownership model that is aligned to PPBEA reform. Business Strategies are focused on innovation and modernization efforts to maintain relevance with Marine and mission. The Marine Corps has been recognized for their forward leaning efforts to establish new service delivery models in order to disrupt old think and antiquated business behaviors.</p>
				<hr />
				<h2 id="overarching-goals">OVERARCHING GOALS</h2>
				<h3 id="focus-on-the-individual-marine-and-their-family.">Focus on the individual Marine and their family.</h3>
				<p>We will listen to the voice of Marines and their families through constant program evaluations and knee cap to knee cap conversations, and will adapt our programs and services to meet both their career and life events. We will stay attuned to environmental, market, and mission conditions that afford the best chance of remaining relevant and responsive to the demographics of our Corps.</p>
				<h3 id="unity-of-efforts-and-purpose-across-mccs-in-the-execution-of-prevention-activities.">Unity of efforts and purpose across MCCS in the execution of prevention activities.</h3>
				<p>Problematic behaviors continue to impact the Marine Corps and unit readiness. They impact our Marines and families and they can disrupt mission readiness and force lethality. MCCS must take additional steps to reduce problematic behaviors and promote positive behaviors and institutionalize conditions and attitudes that sustain progress and align prevention efforts across the Marine Corps.</p>
				<h3 id="build-multi-capable-and-adaptable-programs-and-services.">Build multi-capable and adaptable programs and services.</h3>
				<p>Our programs and services will be delivered through a synergistic and multi-capable model that is not impeded by boundaries and lack of collaboration. We will exploit the integrated characteristics of our organization, the skill set of our employees, and innovative approaches and technologies to deliver programs. We will develop and maintain a strategically relevant expeditionary and home-station capacity, with the freedom to maneuver, as required.</p>
				<h3 id="posture-to-better-counter-threats-in-complex-business-operating-environments.">Posture to better counter “Threats” in complex business operating environments.</h3>
				<p>We recognize that threats pose a significant impact and barrier to our ability to effectively serve Marines and their families. Once discovered, these barriers must be mitigated through continual process improvements and business re-engineering initiatives. As such, the organization will endeavor to meet established benchmarks, standards, and policies that are necessary to position the organization for success.</p>
				<h3 id="invigorate-partnerships-and-internal-and-external-relationships.">Invigorate Partnerships and Internal and External Relationships.</h3>
				<p>We will pursue internal and external strategic partnerships designed to enhance our current capabilities, and improve access and availability of programs and services both on and off the installation. We will also build strong relationships with other service providers and work in unison to address and meet divergent needs and to partner for prevention.</p>
				<h3 id="expand-presence-and-communication.">Expand presence and communication.</h3>
				<p>The image of Marine Corps Community Services must be understood throughout the Marine Corps. Marketing and communication plans, as well as official Marine Corps awareness programs, will be implemented to aggressively promote programs and services in order to ensure that our message is ubiquitous throughout the Corps. Messaging will be multifaceted to meet the multigenerational communication needs of Marines and their Families.</p>
				<h3 id="become-a-critical-enabler-for-programs-and-services-to-support-marines-and-their-families.">Become a “Critical Enabler” for Programs and Services to support Marines and their Families.</h3>
				<p>We will be built on management principles, plans and policies that provide the necessary tools to effectively and efficiently deliver programs and services. Integrated training, technical assistance and enhanced communications will be used to implement and exploit best practices and lessons-learned</p>
				<hr />
				<h2 id="supporting-capabilities">SUPPORTING CAPABILITIES</h2>
				<h3 id="community-based-perspectives.">Community Based Perspectives.</h3>
				<p>Marines and their families are the centerpiece of the Corps and our MCCS programs. This is a team effort and dependent on quality, integrated relationships across all levels of command. Our support to Marines and families must be responsive and adaptive to the Fleet Marine Force and all commanders and organizations who are engaged in the development, education, health, and welfare of Marines and families.</p>
				<h3 id="building-program-excellence-and-an-innovation-culture.">Building Program Excellence and an Innovation Culture.</h3>
				<p>Our MCCS programs must address the unique challenges of the Marine Corps lifestyle. We expect excellence and nothing less. We continuously assess our programs so they provide a continuum of care throughout the Marines and families military lifecycle, addressing the balance of mission, life, and career events. We rapid prototype new business ventures and pilot test new services that are informed by in-depth research and leverage partnerships, sponsorships and technology to remain relevant in our mission contributions.</p>
				<h3 id="honing-the-warfighting-mindset.">Honing the Warfighting Mindset.</h3>
				<p>We develop programming and provide opportunities for Marine and families to develop readiness and resiliency skill sets. Enhancing their social relationships and support structures strengthen independence to navigate the military lifestyle when duty calls. Mind, body, spirit, and social are critical components of overall well-being and readiness.</p>
				<h3 id="funding-for-success">Funding for Success</h3>
				<p>We will be fiscally responsible and invest in readiness. We validate requirements and needs through a data driven approach. We plan, program, budget and execute resources to sustain valued programs and services and a well maintained infrastructure. MCCS BOD strategy and funding decisions are informed by strategic plans and a prioritization and risk management framework within the overarching MCCS PPBEA reform. We make hard decisions to prioritize resources to address the most important and relevant requirements. Likewise, we leverage the MCCS BOD and senior leaders to identify areas of divestiture.</p>
				<p>Reference: MCCS Integrated Strategic Guidance <a href="https://mccsorg-my.sharepoint.com/:b:/g/personal/jason_barnes_usmc-mccs_org/ESIbRg1PR9tMu8YLVtzJKkABncamySFqIZnTYB7Zv3bxQQ?e=ptuZJb">link</a></p>
		</div>

		<div id="facilities" class="tab-pane container-fluid fade">
			<!-- <button id="genPDF">generate PDF</button> -->
			
			<aside>
				<nav id="facToc">
				</nav>
			</aside>

			<div id="FacContents">
				
				<div class="container" id="FacDesc">
						<h1>MCCS Facilities Exploratory Analysis</h1>
						<p>Note: The current report is based on utilization information unless otherwise noted.</p>
						<p>Facility Sustainment, Restortation, and Modernization (FSRM) calculations are resource agnostic.</p>
						<p>Data dictionary and assumptions are at the end of this report.</p>
						<p>Raw  data pulled from GoRPM on <i>make this autofilled date from file</i>.</p>
						<p>Download raw data here: <a target="_blank" rel="noopener noreferrer"  href="https://github.com/rkto11/mccs/raw/main/data/MCCS%20Facility%20Inventory%20Report%20-%202022-10-20_14-16-37.XLSX" download>link</a></p>
						<p>Download cleaned data here: <a target="_blank" rel="noopener noreferrer" href="https://raw.githubusercontent.com/rkto11/mccs/main/data/df_final.csv" download="df_final.xlsx">link</a></p>
				</div>
				<hr><br>
				<div class="container" id="FacCharts">
					<h2>Exploring Costs</h2>
					<h3>Cost by Category</h3>
					<p> Facility Sustainment, Resportation, and Modernization (FSRM) </p>
					<br>
					
						<div class="nav nav-pills me-3 center" id="pills-tab" role="tablist">
						  <button class="nav-link active" id="pills-cost-category" data-bs-toggle="pill" data-bs-target="#cost-category" type="button" role="tab" aria-controls="cost-category" aria-selected="true" onclick="updatebar('catdata')">Category</button>
						  <button class="nav-link" id="pills-cost-region" data-bs-toggle="pill" data-bs-target="#cost-region" type="button" role="tab" aria-controls="cost-region" aria-selected="false" button onclick="updatebar('regdata')">Region</button>
						  <button class="nav-link" id="pills-cost-catc" data-bs-toggle="pill" data-bs-target="#cost-catc" type="button" role="tab" aria-controls="cost-catc" aria-selected="false" onclick="updatebar('regdata')">Cat C</button>
						  <button class="nav-link" id="pills-cost-installation" data-bs-toggle="pill" data-bs-target="#cost-installation" type="button" role="tab" aria-controls="cost-installation" aria-selected="false" onclick="updatebar('instdata')">Installation</button>
						  <button class="nav-link" id="pills-cost-program" data-bs-toggle="pill" data-bs-target="#cost-program" type="button" role="tab" aria-controls="cost-program" aria-selected="false" onclick="updatebar('prodata')">Program</button>
						  <button class="nav-link" id="pills-cost-ccn" data-bs-toggle="pill" data-bs-target="#cost-ccn" type="button" role="tab" aria-controls="cost-ccn" aria-selected="false" onclick="updatebar('prodata')">Use Category</button>
						</div>
						<div class="tab-content" id="v-pills-tabContent">
						  <div class="tab-pane fade show active" id="cost-category" role="tabpanel" aria-labelledby="pills-cost-category">
							<h4>FY24 MCCS FSRM Cost by Category</h4>
							<table class="table display dt-responsive" id="tabCat" style="width:100%"></table>
							<p><Strong>What is the percent of total square foot utilization by Category?</Strong></p>
							<p>Category C accounts for 46% of MCCS total utilization.</p>
						  </div>

						  <div class="tab-pane fade" id="cost-region" role="tabpanel" aria-labelledby="pills-cost-region">
							<h4>FY24 MCCS FSRM Cost by Region</h4>
							<table class="table display dt-responsive" id="tabRegion" style="width:100%"></table>
							<p><strong>What is the percent of total sqft utilization by Region?</strong></p>
							<p>MCIEAST, MCIPAC, MCIWEST account for over 82% of the total MCCS square feet utilization.</p>
							<p><strong>What is the FSRM costs per square foot utilization by Region?</strong></p>
							<p>Locations without a Region have substantially greater costs for FSRM per square foot utilization.</p>
						  </div>

						  <div class="tab-pane fade" id="cost-catc" role="tabpanel" aria-labelledby="pills-cost-catc">
							<h4>FY24 MCCS FSRM Cost by Region Cat C</h4>
							<table class="table display dt-responsive" id="tabRegionC" style="width:100%"></table>
						  </div>

						  <div class="tab-pane fade" id="cost-installation" role="tabpanel" aria-labelledby="pills-cost-installation">
							<h4>FY24 MCCS FSRM Cost by Installation</h4>
							<table class="table display dt-responsive" id="tabInstallation" style="width:100%"></table>
							<p><strong>What is the percent of total sqft utilization by Installation?</strong></p>
							<p>Not surprisingly, Camp Lejeune and Camp Pendleton account for approximately 32% of the total square footage of MCCS. The top 10 out of 26 installations account for 83% of MCCS total infrastructure.</p>
						  </div>

						  <div class="tab-pane fade" id="cost-program" role="tabpanel" aria-labelledby="pills-cost-program">
							<h4>FY24 MCCS FSRM Cost by Program</h4>
							<table class="table display dt-responsive" id="tabProgram" style="width:100%"></table>
							<h5>What is percent of total square foot utilization by Program?</h5>
							<p><strong>Exchange Operations, Semper Fit Programs, Marine &amp; Family Programs</strong> account for roughly <strong>68%</strong> of MCCS total square foot utilization.</p>
							<p>While Food &amp; Beverage (Direct) only accounts for just over <strong>4%</strong> of the total MCCS sqft utilization it ranks number <strong>7</strong> in total FSRM costs at a total cost of <strong>$10,467,504</strong> or <strong>4%</strong> of all FSRM costs.</p>
							<h5>What is the FSRM cost per square foot utilization by Program?</h5>
							<p>The cost per sqft by program is <strong>$16.58</strong>.</p>
						  </div>

						  <div class="tab-pane fade" id="cost-ccn" role="tabpanel" aria-labelledby="pills-cost-ccn">
							<h4>FY24 MCCS FSRM Cost by Use Category</h4>
							<table class="table display dt-responsive" id="tabCCN" style="width:100%"></table>
							<h4>Use Category Top 10</h4>
							<p><em>Facility Type Code</em> — The Facility Type Code determines the category code of the facility. The code ranges from category I to category IV and is tied to the DoD FAC Code. Each Category Code has an accompanying category use description.</p>
							<p>There are a total of <strong>72</strong> distinct use categories within data set. The top 10 use category descriptions account for over <strong>62%</strong> of the total costs in the MCCS portfolio.</p>
						  </div>
						
					  </div>
					<!--see createtables.js for table generation
					<h4>FY24 MCCS FSRM Cost by Category</h4>
						<table class="table display dt-responsive" id="tabCat" style="width:100%"></table>

					<h4>FY24 MCCS FSRM Cost by Region</h4>
						<table class="table display dt-responsive" id="tabRegion" style="width:100%"></table>

					<h4>FY24 MCCS FSRM Cost by Region Cat C</h4>
						<table class="table display dt-responsive" id="tabRegionC" style="width:100%"></table>

					<h4>FY24 MCCS FSRM Cost by Program</h4>
						<table class="table display dt-responsive" id="tabProgram" style="width:100%"></table>

					<h4>FY24 MCCS FSRM Cost by Use Category</h4>
						<table class="table display dt-responsive" id="tabCCN" style="width:100%"></table>
						-->
				</div>
				
				<div class="container" id="FacGraphs">
					<div id="sqftbar">
						<!-- <button onclick="updatebar('catdata')">Category</button>
						<button onclick="updatebar('regdata')">Region</button>
						<button onclick="updatebar('instdata')">Installation</button> -->
						<div id="groupedsqft"></div>
					</div>
					<hr><br>
					<div id="g1">
						<h3>Exploring Utilization Over Time</h3>
						<p>Total utilization of MCCS according to iNFADS is 14,150,438 square feet (Total Measure = adq + iadq + sub).
							<br>
							Note: Utilization such as athletic fields, outdoor playing courts (basketball, volleyball, etc.), playgrounds and Marina/Boat Ramps are typically not included in total measure of square foot utilization)
							<br>
							Note: The trends are based on MCCS existing utilization by age.</p>
						<div id="sqftovertime"></div>
					</div>
					<script src="./js/creategraphs.js"></script>
				</div>
				<hr><br>
				<div class="container" id="qrating">
					<h2>Exploring Q-Rating</h2>
					<div style="text-align: left">
						<p>Number of <b>facilities</b> by Q-Rating</p>
						<p id="pq1"></p>
					</div>

					<div class="nav nav-pills me-3 center" id="pills-tab" role="tablist">
						<button class="nav-link active" id="pills-q-category" data-bs-toggle="pill" data-bs-target="#q-category" type="button" role="tab" aria-controls="q-category" aria-selected="true">Category</button>
						<button class="nav-link" id="pills-q-region" data-bs-toggle="pill" data-bs-target="#q-region" type="button" role="tab" aria-controls="q-region" aria-selected="false">Region</button>
						<button class="nav-link" id="pills-q-installation" data-bs-toggle="pill" data-bs-target="#q-installation" type="button" role="tab" aria-controls="q-installation" aria-selected="false">Installation</button>
						<button class="nav-link" id="pills-q-program" data-bs-toggle="pill" data-bs-target="#q-program" type="button" role="tab" aria-controls="q-program" aria-selected="false">Program</button>
					  </div>
					  <div class="tab-content" id="q-pills-tabContent">
						<div class="tab-pane fade show active" id="q-category" role="tabpanel" aria-labelledby="pills-q-category">
							<h4>Category</h4>
							<table class="table display dt-responsive" id="tabCatQ" style="width:100%"></table>
						</div>

						<div class="tab-pane fade" id="q-region" role="tabpanel" aria-labelledby="pills-q-region">
							<h4>Region</h4>
							<table class="table display dt-responsive" id="tabRegQ" style="width:100%"></table>
						</div>

						<div class="tab-pane fade" id="q-program" role="tabpanel" aria-labelledby="pills-q-program">
							<h4>Program</h4>
							<table class="table display dt-responsive" id="tabProQ" style="width:100%"></table>
						</div>

						<div class="tab-pane fade" id="q-installation" role="tabpanel" aria-labelledby="pills-q-installation">
							<h4>Installation</h4>
							<table class="table display dt-responsive" id="tabInsQ" style="width:100%"></table>
						</div>
					<!-- <h4>Category</h4>
					<table class="table display dt-responsive" id="tabCatQ" style="width:100%"></table>
					<h4>Region</h4>
					<table class="table display dt-responsive" id="tabRegQ" style="width:100%"></table>
					<h4>Program</h4>
					<table class="table display dt-responsive" id="tabProQ" style="width:100%"></table>
					<h4>Installation</h4>
					<table class="table display dt-responsive" id="tabInsQ" style="width:100%"></table> -->
				</div>
				</div>
				<hr><br>
				<div class="container" id="FacStats">
					<h2>Exploring the age of facilities</h2>
					<h4>Q-Rating</h4>

					<div class="nav nav-pills me-3 center" id="pills-tab" role="tablist">
						<button class="nav-link active" id="pills-age-q" data-bs-toggle="pill" data-bs-target="#age-q" type="button" role="tab" aria-controls="age-q" aria-selected="true" onclick="boxplot('QRating')">Q-Rating</button>
						<button class="nav-link" id="pills-age-category" data-bs-toggle="pill" data-bs-target="#age-category" type="button" role="tab" aria-controls="age-category" aria-selected="false" onclick="boxplot('Category')">Category</button>
						<button class="nav-link" id="pills-age-region" data-bs-toggle="pill" data-bs-target="#age-region" type="button" role="tab" aria-controls="age-region" aria-selected="false" onclick="boxplot('Region')">Region</button>
						<button class="nav-link" id="pills-age-installation" data-bs-toggle="pill" data-bs-target="#age-installation" type="button" role="tab" aria-controls="age-installation" aria-selected="false" onclick="boxplot('Installation')">Installation</button>
						<button class="nav-link" id="pills-age-program" data-bs-toggle="pill" data-bs-target="#age-program" type="button" role="tab" aria-controls="age-program" aria-selected="false">Program</button>
						<button class="nav-link" id="pills-age-ccn" data-bs-toggle="pill" data-bs-target="#age-ccn" type="button" role="tab" aria-controls="age-ccn" aria-selected="false">Use Category</button>
					</div>

					<div class="tab-content" id="age-pills-tabContent">
						<div class="tab-pane fade show active" id="age-q" role="tabpanel" aria-labelledby="pills-age-q">
							<h4>Q-Rating</h4>
							<table class="table display dt-responsive" id="tabQStats" style="width:100%"></table>
							<div id="qBox"></div>
						</div>

						<div class="tab-pane fade" id="age-category" role="tabpanel" aria-labelledby="pills-age-category">
							<h4>Category</h4>
							<table class="table display dt-responsive" id="tabCatStats" style="width:100%"></table>
							<div id="catBox"></div>
						</div>

						<div class="tab-pane fade" id="age-region" role="tabpanel" aria-labelledby="pills-age-region">
							<h4>Region</h4>
							<table class="table display dt-responsive" id="tabRegStats" style="width:100%"></table>
							<div id="regBox"></div>

						</div>

						<div class="tab-pane fade" id="age-program" role="tabpanel" aria-labelledby="pills-age-program">
							<h4>Program</h4>
							<table class="table display dt-responsive" id="tabProStats" style="width:100%"></table>
							<div id="proBox"></div>
						</div>

						<div class="tab-pane fade" id="age-installation" role="tabpanel" aria-labelledby="pills-age-installation">
							<h4>Installation</h4>
							<table class="table display dt-responsive" id="tabInsStats" style="width:100%"></table>
							<div id="insBox"></div>
						</div>

						<div class="tab-pane fade" id="age-ccn" role="tabpanel" aria-labelledby="pills-age-ccn">
							<h4>Use Category</h4>
							<table class="table display dt-responsive" id="tabCCNStats" style="width:100%"></table>
						</div>
					</div>
					
					<div id="allboxplots">
						<!-- <button onclick="boxplot('QRating')">Q-Rating</button>
						<button onclick="boxplot('Category')">Category</button>
						<button onclick="boxplot('Region')">Region</button>
						<button onclick="boxplot('Installation')">Installation</button> -->
						<div id="allBox"></div>
						<script src="./js/box.js"></script>

					</div>

				</div>
				
				<hr>
				<div id="data-dictionary" class="section level1" style="text-align: left">
				<h1 class="text-center">Data Dictionary</h1>
				<p><strong>Region:</strong> Installations grouped within their perspective geographical region. There is a total of 5 regions (MCIWEST, MCIEAST, MCIPAC, MCINCR, SLTI) The following locations are not associated with a region in the data set:</p>
				<ol style="list-style-type: decimal">
				<li><p>Garden City</p></li>
				<li><p>Camp Elmore</p></li>
				<li><p>Kansas City</p></li>
				<li><p>MARFORRES</p></li>
				<li><p>4th MARDIV</p></li>
				</ol>
				<p><strong>Installation:</strong> The name of the installation MCCS services are provided. Installation is derived from the MCCS Installation Name column in iNFADS.</p>
				<p><strong>RPUID:</strong> The real property unique identifier (RPUID) is a non-intelligent code used to permanently and uniquely identify a real property asset. (Primary Key to connect facilities with utilization).</p>
				<hr />
				<p><strong>NAF Category, Program</strong> are mapped to iNFADS use_codes based on the the following:</p>
				<p><a href="https://mccsorg-my.sharepoint.com/:x:/g/personal/jason_barnes_usmc-mccs_org/EY2pByxnvI5AkBjH0x53k4EB5TkkKThKs7aqM1JOGzB_9w?e=UgoQrB">MCCS Category Codes Worksheet</a></p>
				<p><strong>use_code:</strong> A five-digit system of numbering a common nomenclature for classes 1 and 2 plant property. See NAVFAC P-72, Department of the Navy Facility Category Codes, for a listing of recognized codes.</p>
				<p><strong>use_desc:</strong> The title of the use category associated with the Category Use Code (use_code) derived from the Appendix A - Category Codes for Navy and Marine Corps Real Property Replacement for NAVFAC P72.</p>
				<p><strong>fac_use:</strong> Identifies the use of a Navy or Marine Corps facility (or portion thereof).</p>
				<p><strong>PRV:</strong> PRV is the cost to replace an existing facility with a generic facility that can perform the same function(s). The notional replacement facility is generally understood to be the same size and to occupy the same site as the existing facility. The notional replacement facility is also assumed to be constructed to current standards of materials and design. Since each facility has its own theoretical PRV, no facility PRV should contain costs associated with any other facility. Therefore, PRV costs are considered to extend only to the five-foot line surrounding the facility. This estimate applies to all facilities regardless of funding source and does not include land or leasing costs. The PRV is calculated at the Use level and is based on the standard DoD algorithm:</p>
				<blockquote>
				<p>Plant Replacement Value = Facility Quantity<sup>1</sup>x Construction Cost Factor<sup>2</sup>x Area Cost Factor<sup>3</sup>x Historical Records Adjustment<sup>4</sup>x Planning and Design Factor<sup>5</sup>x Supervision Inspection and Overhead Factor<sup>6</sup>x Contingency Factor<sup>7</sup></p>
				</blockquote>
				<p><sup>1</sup> The Facility Quantity is the sum total of assets at the Use/User level.</p>
				<p><sup>2</sup> The Construction Cost Factor is the cost value for a specific DoD Facility Analysis Code (FAC) and is “unit of measure” specific. This value is stored in the Category Code Module and updated upon the annual release of the latest version of the DoD Facilities Pricing Guide from a spreadsheet provided by NAVFAC HQ.</p>
				<p><sup>3</sup> The Geographical Area Cost Factor is a value carried on the city table. This value is stored in the RPI and updated at year-end from a spreadsheet provided by NAVFAC HQ.</p>
				<p><sup>4</sup> The Historic Records Adjustment Factor is an adjustment to account for increased costs for replacement of historical facilities or for construction in a historic district. The current factor is 1.05 and is based on the Historic/Heritage Asset data elements in iNFADS (DE 410a-d).</p>
				<p><sup>5</sup> The Planning and Design Factor accounts for the planning and design of a facility. The current value of this factor is 1.09 for all but medical facilities and 1.13 for medical facilities. Assignment of this factor is based on the Category Code Number of the Use/User record.</p>
				<p><sup>6</sup> The Supervision, Inspection and Overhead Factor accounts for the supervision, inspection, and overhead activities associated with the management of a construction project. The current value of the factor is 1.06 for facilities in the continental US (CONUS) and 1.065 for facilities outside of the continental US (OCONUS). Assignment of this factor is based on the Country Code and State Code.</p>
				<p><sup>7</sup> The Contingency Factor accounts for construction contingencies; the current value of the factor is 1.05. PRV appears in the NAVFAC Public Works (Assessment) drills, Facility Maintenance Responsibility Report and various budget exhibits.</p>
				<p><strong>Sustainment:</strong> Sustainment provides resources for maintenance and repair activities necessary to keep an inventory of facilities in good working order over a 50-year service life. It includes regularly scheduled adjustments and inspections, preventive maintenance tasks, and emergency response and service calls for minor repairs. It also includes major repairs or replacement of facility components that are expected to occur periodically throughout the facility life-cycle.</p>
				<p>GENERAL POLICY FOR SUSTAINMENT</p>
				<ol style="list-style-type: decimal">
				<li><p>The work includes regular roof replacement, refinishing wall surfaces, repairing and replacing heating, ventilation and air conditioning (HVAC) systems, replacing tile and carpeting, and similar type work. When sustainment involves replacement of constituent parts, the items installed shall serve the same purpose.</p></li>
				<li><p>Sustainment does not include any construction. Sustainment does not include repairing or replacing non-attached equipment or furniture, or building components that typically last more than 50 years (e.g., foundation and structural members). Sustainment does not include repair work classified as restoration or modernization, environmental compliance, or historical preservation. Other tasks associated with facilities operations (such as custodial services, grass cutting, landscaping, waste disposal, and the provision of central utilities) are also not included.</p></li>
				<li><p>Replacing landscaping destroyed by a sustainment project shall be classified as sustainment.</p></li>
				</ol>
				<blockquote>
				<p><em>Sustainment</em>: The calculation in this report for Cat C utilizations is 2x iNFADS FSM calculated Sustainment costs; <br> Cat A, Cat B and Lodging utilizations (FSM calculated sustainment costs)</p>
				</blockquote>
				<p><strong>Restoration and Modernization:</strong> Restoration and Modernization provides resources for improving facilities. Restoration includes repair and replacement work to restore facilities damaged by inadequate sustainment, excessive age, natural disasters, fire, accident, or other cases. Modernization includes construction or alteration of facilities solely to implement a new or higher standard (including regulatory changes), to accommodate new functions, or replace building components that typically last more than 50 years (e.g., foundations and structural members).</p>
				<p>GENERAL POLICY FOR RESTORATION AND MODERNIZATION</p>
				<ol style="list-style-type: decimal">
				<li><p>Restoration and modernization does not include recurring sustainment tasks or certain environmental measures that are funded elsewhere.</p></li>
				<li><p>Other tasks associated with facilities operations (such as custodial services, grass cutting, landscaping, waste disposal, and the provision of central utilities) are also not included.</p></li>
				</ol>
				<blockquote>
				<p><em>R &amp; M</em>: The calculation in this report is based on 2.5% of the facilities Plant Replacement Value (PRV), this calculation assumes facility is fully recapitalized and that sustainment costs are being applied annually to each facility.</p>
				</blockquote>
				<p><strong>Adequate Area Measure (adq):</strong> The capacity or size in area measure of a facility or portion thereof that is in adequate condition and associated with a designated function (use) and a designated user. Adequate is defined as being capable of supporting the designated function without a need for capital improvements.</p>
				<p><strong>Adequate Other Measure (abq Other):</strong> The capacity or size in other measure of a facility or portion thereof that is in adequate condition and associated with a designated function (use) and a designated user. Adequate is defined as being capable of supporting the designated function without a need for capital improvements.</p>
				<p><strong>Adequate Alternate Measure (adq Alt):</strong> The capacity or size in alternate measure of a facility or portion thereof that is associated with a designated function (use) and designated user. Adequate is defined as being capable of supporting the designated function without a need for capital improvements.</p>
				<p><strong>Substandard Area Measure (sub)</strong> The capacity or size in the area measure of a facility or portion thereof that is in substandard condition and associated with a designated function (use) and a designated user. Substandard is defined as having deficiencies that prohibit or severely restrict, or will prohibit or severely restrict within the next five years due to expected deterioration, the use of a facility for its designated function. Capital improvements and/or repairs further define Substandard as having deficiencies that can be economically corrected (compared with replacement).</p>
				<p><strong>Substandard Other Measure (sub_other):</strong> The capacity or size in other measure of a facility or portion thereof that is in substandard condition and associated with a designated function (use) and designated user. Substandard is defined as having deficiencies that prohibit or severely restrict, or will prohibit or severely restrict within the next five years due to expected deterioration, the use of a facility for its designated function. Capital improvements and/or repairs further define Substandard as having deficiencies that can be economically corrected (compared with replacement).</p>
				<p><strong>Substandard Alternate Measure (sub_alt):</strong> The capacity or size in alternate measure of a facility or portion thereof that is in substandard condition and associated with a designated function (use) and designated user. Substandard is defined as having deficiencies that prohibit or severely restrict, or will prohibit or severely restrict within the next five years due to expected deterioration, the use of a facility for its designated function. Capital improvements and/or repairs further define Substandard as having deficiencies that can be economically corrected (compared with replacement).</p>
				<p><strong>Inadequate Area Measure (iadq):</strong> The capacity or size in area measure of a facility or portion thereof that is in inadequate condition and associated with a designated function (use) and a designated user. Inadequate is defined as having deficiencies due to physical deterioration, functional inadequacy or hazardous location which prohibit or severely restrict, or will prohibit or severely restrict within the next five years, the use of a facility for its designated function. Inadequate is further defined as having deficiencies, which cannot be economically corrected (compared with replacement) to meet the requirements of the designated function.</p>
				<p><strong>Inadequate Other Measure (iadq_other):</strong> The capacity or size in other measure of a facility or portion thereof that is in inadequate condition and associated with a designated function (use) and a designated user. Inadequate is defined as having deficiencies due to physical deterioration, functional inadequacy or hazardous location which prohibit or severely restrict, or will prohibit or severely restrict within the next five years, the use of a facility for its designated function. Inadequate is further defined as having deficiencies, which cannot be economically corrected (compared with replacement) to meet the requirements of the designated function.</p>
				<p><strong>Inadequate Alternate Measure (iadq_alt):</strong> The capacity or size in alternate measure of a facility or portion thereof that is in inadequate condition and associated with a designated function (use) and a designated user. Inadequate is defined as having deficiencies due to physical deterioration, functional inadequacy or hazardous location which prohibit or severely restrict, or will prohibit or severely restrict within the next five years, the use of a facility for its designated function. Inadequate is further defined as having deficiencies, which cannot be economically corrected (compared with replacement) to meet the requirements of the designated function.</p>
				<p><strong>Build_dt:</strong> The century and year, e.g., 20XX, when the initial construction of a Class 2 facility was completed. Where not available, a “best estimate” is used.</p>
				<p>References: <a href="https://www.navfac.navy.mil/products_and_services/am/about_us/resources.html">NAVFAC P-78</a> | <a href="https://www.wbdg.org/ffc/dod/unified-facilities-criteria-ufc/ufc-2-000-05n">NAVFAC P-72</a> | <a href="https://www.wbdg.org/ffc/dod/unified-facilities-criteria-ufc/ufc-2-000-05n">NAVFAC Appendix A P72</a> | <a href="https://www.marines.mil/Portals/1/Publications/MCO%20P11000.5G%20W%20CH%201.pdf">MCO P11000.5G</a></p>
				</div>
			</div>
		</div>
		

		<div id="facrecap" class="tab-pane container fade">
			<h1>Recapitalization Plan</h1>
			<div>
				<table class="gt_table" style="margin: 0px auto">
					<thead class="gt_header">
					  <tr>
						<th colspan="3" class="gt_heading gt_title gt_font_normal" style>R&amp;M Schedule for <em>FY24</em> by Installation<sup class="gt_footnote_marks">1</sup></th>
					  </tr>
					  <tr>
						<th colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style>*<em>GoRPM</em> data retrieved <strong>Oct 20, 2022</strong></th>
					  </tr>
					</thead>
					<thead class="gt_col_headings">
					  <tr>
						<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1"></th>
						<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Installation</th>
						<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Count</th>
					  </tr>
					</thead>
					<tbody class="gt_table_body">
					  <tr><td class="gt_row gt_left gt_stub"></td>
				  <td class="gt_row gt_left">MCB Lejeune</td>
				  <td class="gt_row gt_left">16</td></tr>
					  <tr><td class="gt_row gt_left gt_stub"></td>
				  <td class="gt_row gt_left">MCB Pendleton</td>
				  <td class="gt_row gt_left">15</td></tr>
					  <tr><td class="gt_row gt_left gt_stub"></td>
				  <td class="gt_row gt_left">MCB Hawaii</td>
				  <td class="gt_row gt_left">9</td></tr>
					  <tr><td class="gt_row gt_left gt_stub"></td>
				  <td class="gt_row gt_left">MCAS Yuma</td>
				  <td class="gt_row gt_left">5</td></tr>
					  <tr><td class="gt_row gt_left gt_stub"></td>
				  <td class="gt_row gt_left">MCB Quantico</td>
				  <td class="gt_row gt_left">5</td></tr>
					  <tr><td class="gt_row gt_left gt_stub"></td>
				  <td class="gt_row gt_left">Camp Elmore</td>
				  <td class="gt_row gt_left">4</td></tr>
					  <tr><td class="gt_row gt_left gt_stub"></td>
				  <td class="gt_row gt_left">MCAS Cherry Point</td>
				  <td class="gt_row gt_left">3</td></tr>
					  <tr><td class="gt_row gt_left gt_stub"></td>
				  <td class="gt_row gt_left">MCAS Iwakuni</td>
				  <td class="gt_row gt_left">3</td></tr>
					  <tr><td class="gt_row gt_left gt_stub"></td>
				  <td class="gt_row gt_left">MCAS Miramar</td>
				  <td class="gt_row gt_left">3</td></tr>
					  <tr><td class="gt_row gt_left gt_stub"></td>
				  <td class="gt_row gt_left">MCRD PI</td>
				  <td class="gt_row gt_left">3</td></tr>
					  <tr><td class="gt_row gt_left gt_stub"></td>
				  <td class="gt_row gt_left">MCAS New River</td>
				  <td class="gt_row gt_left">2</td></tr>
					  <tr><td class="gt_row gt_left gt_stub"></td>
				  <td class="gt_row gt_left">MCLB Barstow</td>
				  <td class="gt_row gt_left">2</td></tr>
					  <tr><td class="gt_row gt_left gt_stub"></td>
				  <td class="gt_row gt_left">Garden City</td>
				  <td class="gt_row gt_left">1</td></tr>
					  <tr><td class="gt_row gt_left gt_stub"></td>
				  <td class="gt_row gt_left">MBW (8th &amp; I)</td>
				  <td class="gt_row gt_left">1</td></tr>
					  <tr><td class="gt_row gt_left gt_stub"></td>
				  <td class="gt_row gt_left">MCAGCC 29 Palms</td>
				  <td class="gt_row gt_left">1</td></tr>
					  <tr><td class="gt_row gt_left gt_stub"></td>
				  <td class="gt_row gt_left">MCB Butler</td>
				  <td class="gt_row gt_left">1</td></tr>
					  <tr>
						<td class="gt_row gt_stub gt_right gt_grand_summary_row gt_first_grand_summary_row">Total</td>
						<td class="gt_row gt_left gt_grand_summary_row gt_first_grand_summary_row">Installation Count</td>
						<td class="gt_row gt_left gt_grand_summary_row gt_first_grand_summary_row">74</td>
					  </tr>
					</tbody>
					
					<tfoot>
					  <tr class="gt_footnotes">
						<td colspan="3">
						  <p class="gt_footnote">
							<sup class="gt_footnote_marks">
							  <em>1</em>
							</sup>
							 
							Number of facilities by Installation to conduct ICI for scope and estimate
							<br />
						  </p>
						</td>
					  </tr>
					</tfoot>
				  </table>

			</div>
		</div>


		<div id="lodging" class="tab-pane container fade">
		</div>

		<div id="catc" class="tab-pane container fade">
		</div>


		<div id="dataentry" class="tab-pane container fade ">
			<form id="myForm">
				<h2>Select CSV 1</h2>
				<input type="file" id="csvFile" accept=".csv" />
				<h2>Select CSV 2</h2>
				<input type="file" id="csvFile2" accept=".csv" />
				<br />
				<input type="submit" id="submit2" value="Submit" />
			</form>
			<script>
				const myForm = document.getElementById("myForm");
				const csvFile = document.getElementById("csvFile");
			

				myForm.addEventListener("submit" , function (e) {
					e.preventDefault();
					const input = csvFile.files[0];
					
					const reader = new FileReader();
					reader.onload = function (e) {
						const text = e.target.result;
						const data = CSVToArray(text);
						//var jsonObject = JSON.stringify(data);
						
						//create a data type checker here to determine process function

						//async function to load/process second sheet

						var csv = ConvertToCSV(data);
						var csvData = new  Blob([csv], {type: 'text/csv'});
						var csvURL = URL.createObjectURL(csvData);
						window.open(csvURL);
						//window.open(encodeURI(ConvertToCSV(data)));
					};
					reader.readAsText(input);
					

				});

				function CSVToArray(strData, strDelimiter){
					// Check to see if the delimiter is defined. If not,
					// then default to comma.
					strDelimiter = (strDelimiter || ",");

					// Create a regular expression to parse the CSV values.
					var objPattern = new RegExp(
							(
									// Delimiters.
									"(\\" + strDelimiter + "|\\r?\\n|\\r|^)" +

									// Quoted fields.
									"(?:\"([^\"]*(?:\"\"[^\"]*)*)\"|" +

									// Standard fields.
									"([^\"\\" + strDelimiter + "\\r\\n]*))"
							),
							"gi"
							);


					// Create an array to hold our data. Give the array
					// a default empty first row.
					var arrData = [[]];

					// Create an array to hold our individual pattern
					// matching groups.
					var arrMatches = null;

					// Keep looping over the regular expression matches
					// until we can no longer find a match.
					while (arrMatches = objPattern.exec(strData)){
							// Get the delimiter that was found.
							var strMatchedDelimiter = arrMatches[1];
							// Check to see if the given delimiter has a length
							// (is not the start of string) and if it matches
							// field delimiter. If id does not, then we know
							// that this delimiter is a row delimiter.
							if (
									strMatchedDelimiter.length &&
									(strMatchedDelimiter != strDelimiter)
									){
									// Since we have reached a new row of data,
									// add an empty row to our data array.
									arrData.push([]);
							}
							// Now that we have our delimiter out of the way,
							// let's check to see which kind of value we
							// captured (quoted or unquoted).
							if (arrMatches[2]){
									// We found a quoted value. When we capture
									// this value, unescape any double quotes.
									var strMatchedValue = arrMatches[2].replace(
											new RegExp( "\"\"", "g" ),
											"\""
											);
							} else {
									// We found a non-quoted value.
									var strMatchedValue = arrMatches[3];
							}
							// Now that we have our value string, let's add
							// it to the data array.
							arrData[arrData.length-1].push(strMatchedValue);
					}
					
					var keys = arrData[0];
					var result = arrData.map(obj => {
						var replacedObj = {};
						var oriKeys = Object.keys(obj);
						for (var i = 0; i<keys.length; i++) {
							replacedObj[keys[i]] = obj[oriKeys[i]]
						};
						return replacedObj;
					});
					result.shift();

					return(result);
				}
				
				 function ConvertToCSV(arr) {
					//var arr = objArray //!= 'object' ? JSON.parse(objArray) : objArray;
					//var str = 'data:text/csv;charset=utf-8,';
					var str = ''
					var k =  Object.keys(arr[0]);
					for(q = 0; q<k.length; q++){
						str += k[q];
						if (q<k.length-1){
							str+=',';
						}
					}
					str += '\r\n';
					for(var i = 0; i < arr.length-1; i++) {
						var line = '';
						for(var j=0; j<k.length; j++) {
							var key=k[j];
							const tex = String(arr[i][key]);
							const result = tex.indexOf(',');
							if (result>-1){
								line += '"' + arr[i][key] + '"';
							}
							else {
								line += arr[i][key];
							}
							if (j<k.length - 1){
								line += ',';
							}
						}
						str += line + '\r\n';
					}
					return str;
				}
			</script>
		</div>
	</div>
	<script>
		//see createtables.js
		$(document).ready(function () {
			$.get('https://raw.githubusercontent.com/rkto11/mccs/main/data/df_final.csv', function (theData) {
				var data = $.csv.toObjects(theData);
				createCostTables(data);
				createQratingTables(data);
				createAgeTables(data);
				createSqFtLine();
				boxplot('QRating');
			});
		});

		$(document).ready(function () {
			$.get('https://raw.githubusercontent.com/rkto11/mccs/main/data/Recap%20Plan.csv', function (recap) {
				var data = $.csv.toObjects(recap);
			});
		});
		
		function topFunction() {
 			document.body.scrollTop = 0;
  			document.documentElement.scrollTop = 0;
		}

		function popup() {
			document.getElementById("popover-backplate").style.display = "block";
		}

		function popoff(){
			document.getElementById("popover-backplate").style.display = "none";
		}

		$(document).ready(function () {
			$('#genPDF').click(function(){
				$('#FacDesc, #cost-category, #cost-region, #groupedsqft, #groupedsqft').printThis({
					importCSS: false,
					importStyle: false,
					loadCSS: "C:/Users/olsonrk/Documents/html/css/print.css",
				});
			})
		})
	</script>
</body>
</html>